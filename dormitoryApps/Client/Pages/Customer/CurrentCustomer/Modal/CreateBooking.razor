@using Blazorise;
@using dormitoryApps.Shared.Model.Entity;
@using dormitoryApps.Client.Services;
@using System.Timers;
@inject CurrentCustomerService _currentCustomerService;
@inject RoomServices _roomServices;
@inject OfficerServices _officerServices;
@inject SessionServices _sessionServices;
@inject BuildingServices _buildingServices;

@code {
    Modal e;
    Officer Currentofficer = new Officer();
    List<Room> rooms = new List<Room>();
    List<Buildings> buildings = new List<Buildings>();
    string Monthly = "Monthly";
    CurrentCustomer item = new CurrentCustomer() { RentalType = "Monthly", Stayed = DateTime.Now };
    bool IsMonthly = true;
    string[] RentalType = { "Daily", "Monthly" };
    public async void Open()
    {
        await e.Show();
        buildings = await _buildingServices.Get();
        Currentofficer = await _sessionServices.GetCurrentLogin();
        rooms = await _roomServices.GetEnabled();
        if (rooms == null) rooms = new List<Room>();
        StateHasChanged();
    }
    void RentalChanged(ChangeEventArgs e)
    {
        item.RentalType = e.Value.ToString();
        IsMonthly = item.RentalType.ToLower() == Monthly.ToLower();
        StateHasChanged();
    }
}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<Modal Style="color:black" @ref="e">
    <ModalContent Size="ModalSize.Large">
        <ModalHeader>
            <ModalTitle>จองห้อง</ModalTitle>
            <CloseButton></CloseButton>
        </ModalHeader>
        <ModalBody>
            <center>
                <h1>จองห้อง</h1>
            </center>
            <br />
            <br />
            <Div Class="row">
                <Div Class="col">
                    <div class="form-group row">
                        <label for="select" class="col-4 col-form-label">ห้องเลขที่</label>
                        <div class="col-8">
                            <select id="select" @bind="item.RoomId" class="custom-select">
                                @if (rooms == null)
                                {
                                    <option disabled>Loading...</option>
                                }
                                else
                                {
                                    foreach (var room in rooms)
                                    {
                                        <option value="@room.Id">@($"{room.RoomName} ({buildings.Where(x=>x.Id==room.Building).FirstOrDefault().Name})")</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>
                </Div>
                <Div Class="col">
                    <div class="form-group row">
                        <label for="RentalType" class="col-4 col-form-label">ประเภทการเข้าพัก</label>
                        <div class="col-8">
                            <select id="RentalType" @onchange="RentalChanged" class="custom-select">
                                @foreach (var i in RentalType)
                                {
                                    <option value="@i" selected="@(i==Monthly)">@i</option>
                                }
                            </select>
                        </div>
                    </div>
                </Div>
            </Div>
            @if (IsMonthly)
            {
                <Div Class="row">
                    <Div Class="col">
                        <div class="form-group">
                            <label for="text">เข้าพักภายในวันที่</label>
                            <input id="text" @bind-value="item.Stayed" type="date" class="form-control">
                        </div>
                    </Div>
                    <Div Class="col">
                         <div class="form-group">
                            <label for="price">ค่าเข้าพัก(ต่อเดือน)</label>
                            <div class="input-group">
                                <input id="price" @bind-value="item.Rental" type="number" step="0.01" min="1" class="form-control">
                                <div class="input-group-append">
                                    <div class="input-group-text">บาท</div>
                                </div>
                            </div>
                        </div>
                    </Div>
                </Div>
            }
            else
            {
                <Div Class="row">
                    <Div Class="col">
                        <div class="form-group">
                            <label for="Day">เข้าพักวันที่</label>
                            <input id="Day" @bind-value="item.Stayed" min="@DateTime.Now.Date" type="date" class="form-control">
                        </div>
                    </Div>
                    <Div Class="col">
                        <div class="form-group">
                            <label for="Day">ออกวันที่</label>
                            <input id="Day" @bind-value="item.StayUntil" min="@item.Stayed.AddDays(1)" type="date" class="form-control">
                        </div>
                    </Div>
                </Div>
                <Div Class="row">
                    <Div Class="col">
                        <div class="form-group">
                            <label for="price">ค่าเข้าพัก(รวม)</label>
                            <div class="input-group">
                                <input id="price" @bind-value="item.Rental" type="number" step="0.01" min="1" class="form-control">
                                <div class="input-group-append">
                                    <div class="input-group-text">บาท</div>
                                </div>
                            </div>
                        </div>
                    </Div>
                    <Div Class="col">
                        <div class="form-group">
                            <label for="day">จำนวนวันเข้าพัก</label>
                            <div class="input-group">
                                <input id="day" value="@(item.StayUntil.HasValue ? item.StayUntil.Value.Date.Subtract(item.Stayed.Date).Days : 0)" class="form-control" readonly>
                                <div class="input-group-append">
                                    <div class="input-group-text">วัน</div>
                                </div>
                            </div>
                        </div>
                    </Div>
                </Div>
            }
        </ModalBody>
        <ModalFooter>
            <Button Class="btn btn-outline-primary">ทำการจองห้อง</Button>
            <Button Class="btn btn-outline-secondary" @onclick="()=>e.Hide()">ยกเลิก</Button>
        </ModalFooter>
    </ModalContent>
</Modal>
