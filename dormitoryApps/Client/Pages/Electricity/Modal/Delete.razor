@using System;
@using System.Threading;
@using dormitoryApps.Client.Services;
@using dormitoryApps.Shared.Model.Entity;
@using Blazorise;
@inject ElectricityService _electricityService;
@inject SessionServices _sessionServices;
@inject CurrentCustomerService _currentCustomerService;
@inject OfficerServices _officerServices;
@inject RoomServices _roomServices;
@inject BuildingServices _buildingServices;

@code {
    Modal e;
    Electricity thisElectricity = new Electricity();
    public async void Open(string rentalId,int month,int year)
    {
        await e.Show();
        thisElectricity = await _electricityService.GetOne(year, month, rentalId);
        StateHasChanged();
    }
    async void AcceptDelete()
    {
        auto.Open("Deleting");
        await Task.Delay(1);
        try
        {
            var actionResult = await _electricityService.Delete(thisElectricity);
            if(actionResult)
            {
                await e.Hide();
                auto.Success("Electrictity Deleted", "Congratulations");
                await Task.Delay(1);
                StateHasChanged();
                return;
            }
            auto.Failed();
            await Task.Delay(1);
        }
        catch(Exception x)
        {
            auto.Failed(x.Message);
            await Task.Delay(1);
        }
        StateHasChanged();
    }
}
<Modal @ref="e" Style="color:black">
    <ModalContent>
        <ModalHeader>
            <ModalTitle>ยกเลิกรายการใช้ไฟฟ้า</ModalTitle>
            <CloseButton></CloseButton>
        </ModalHeader>
        <ModalBody>
            <center>
                <h1>คุณแน่ใจว่าจะลบราการใช้ไฟฟ้า งวดที่ @($"{thisElectricity.month}/{thisElectricity.Year} ของการเช่าที่ {thisElectricity.RentalId}")  </h1>
            </center>
        </ModalBody>
        <ModalFooter>
            <Button Class="btn btn-outline-danger" @onclick="AcceptDelete">Yes</Button>
            <Button Class="btn btn-outline-success" @onclick="()=>e.Hide()">No</Button>
        </ModalFooter>
    </ModalContent>
</Modal>
<dormitoryApps.Client.Pages.Modal.Auto @ref="auto"/>
@code{
    dormitoryApps.Client.Pages.Modal.Auto auto;
}